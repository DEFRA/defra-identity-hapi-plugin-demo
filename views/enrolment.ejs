<% include layout/top.ejs %>

<div class="breadcrumbs breadcrumb-two-thirds">
    <ol>
        <li><a href="/account/<%= journey %>">Home</a></li>
        <li>Manage Enrolments</li>
    </ol>
</div>

<div class="grid-row">
    <div class="column-full">
        <% if (errorMessage) { %>
        <%- include partials/errorBox.ejs %>
        <% } %>
        <h3 class="heading-large">Choose your enrolment status</h3>
        <% if (enrolmentRequestsCount !== 0) { %>
        <form method="post">
            <div class="row">
                <label for="contactId">ContactId:</label>
                <input type="text" disabled="disabled" value="<%= contactId %>" class="service-selector" />
            </div>
            <div class="row">
                <label for="connectionDetailsId">Organisation:</label>
                <select name="connectionDetailsId" id="connectionDetailsId" class="service-selector">
                    <%- include partials/accountSelectorOptions.ejs %>
                </select>
            </div>
            <div class="row">
                <label for="journey">Service to impersonate: </label>
                <select name="journey" id="journey" class="service-selector">
                    <%- include partials/journeySelectorOptions.ejs %>
                </select>
            </div>
            <div class="row">
                <label for="enrolmentStatusId">Enrolment Status: </label>
                <select name="enrolmentStatusId" id="enrolmentStatusId" class="service-selector">
                    <option value="1">Incomplete</option>
                    <option value="2">Pending</option>
                    <option value="3">Complete - approved</option>
                    <option value="4">Complete - rejected</option>
                </select>
            </div>
            <br>
            <div class="row">
                <button class="button" type="submit" <% if (enrolmentRequestsCount === 0) { %> disabled="disabled"<% } %>)>Submit</button>
            </div>
        </form>
        <hr>
        <% } %>
        <% if (enrolmentRequestsCount === 0) { %>
        <div class="row">There are no unspent enrolmentRequests</div>
        <% } else { %>
        <div class="row">There are <%=enrolmentRequestsCount%> unspent enrolmentRequests</div>
        <% } %>
        <hr>
        <div class="row">
            <% if (parsedAuthzRoles.flat.length) { %>
            <h3 class="heading-large">
                You currently have the following roles in "<%= serviceName %>":
            </h3>
            <table class="govuk-table">
                <tr>
                    <th>Account name</th>
                    <th>Role Name</th>
                    <th>Status</th>
                </tr>
                <%- include partials/currentRoles.ejs %>
            </table>
            <% }else{ %>
            <h3 class="heading-large">
                You currently have no roles with "<%= serviceName %>"
            </h3>
            <% } %>
        </div>
    </div>
</div>
</main>
